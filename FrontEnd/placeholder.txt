Here's a revised version to improve the flow of the processes:

Patient page flow:



**Patient Dashboard Cards:**
- **Care Contracts Card:** Redirects to the patient-contracts page, displaying all care contracts for the patient where the contract status is set to "Assigned."

- **Care Visits Card:** Redirects to the patient-visits page, showing care visits for each of the patient's care contracts where the contract status is set to "Assigned."

**Create Care Contract:**
- Takes the patient to a dedicated page to create their own care contract, specific to them, automatically setting the contract status to 'New.'

- The new care contract then appears on the Office Manager page, Unassigned Care Contracts page. The Office Manager can assign it to a Nurse. After assignment, the contract status automatically changes to "Assigned" and moves to the Assigned Care Contracts page in the Office Manager.

- The newly assigned care contract is then displayed on the patient-contracts page for the patient to view all their assigned care contracts.

**My Care Contracts:**
- Redirects the patient to the patient-contracts page, displaying all care contracts specifically for them with a contract status set to "Assigned."

**My Care Contracts History:**
- Redirects the patient to the patient-history contracts page, displaying all care contracts specifically for them with a contract status set to "Closed."

**Appointments:**
- Takes the patient to view their appointments. Clicking on an appointment button that asks are you sure this apoint has happend/done if click yes then marks it as seen or completed, displaying it differently from new appointments.

- The patient appointment page includes a "Make Appointment" button, leading to a page allowing the patient to schedule an appointment with a nurse assigned to their specific care contracts (where contract status is set to "Assigned"). The appointment is then visible on the chosen nurse's appointment page.

**My Care Visits:**
- Redirects to the patient-visits page, displaying care visits specifically for each of the patient's care contracts where the contract status is set to "Assigned."

**My Care Visit History:**
- Redirects to the patient-history visits page, displaying care visits specifically for each of the patient's care contracts where the contract status is set to "Closed."

**Calendar:**
- Includes a button to add an event. Clicking it opens an add event modal on the calendar page. The "Create Event" button adds the event to the patient's calendar.

- Redirects to the patient-calendar page, using appointment details from the patient's appointments to populate the calendar.

**My Conditions:**
- Redirects to the patient-conditions page, displaying all chronic conditions specifically for the patient with an "Add Condition" button.

- Clicking the "Add Condition" button takes the patient to the patient profile edit page to update and add new conditions.

**Patient Profile Page:**
- Directs to the patient profile page for additional personalization and editing.






public IActionResult Patient()
{
    // Get NurseId from session
    var nurseId = HttpContext.Session.GetInt32("PatientID");

    // Check if PatientID is not null
    if (nurseId.HasValue)
    {
        // Retrieve user and patient information from the database
        var user = _context.Users
            .Include(u => u.Nurses)
            .FirstOrDefault(u => u.UserId == nurseId);

        // Check if user and patient information are not null
        if (user != null && user.Nurses.Any())
        {
            var nurse = user.Patient.First();

            // Set ViewBag data
            ViewBag.UserName = $"{patient.FirstName} {nurse.LastName}";

            // Return the view
            return View();
        }
    }

    // Handle the case when PatientID is null or user/patient information is not found
    return RedirectToAction("Login", "Login"); // Redirect to login page or handle it appropriately
}
